#!/bin/bash

ds="`date`"

dt="`date "+%Y%m%d%H%M"`"
acc=$1
com=$(hostname -s)
com_syschk=$com\_syschk\_$dt
rm -rf $com_syschk

mkdir $com_syschk

clear

#########################################
# Log Path
#########################################

# Account
a01=$com_syschk"/a01.account.log"
a02=$com_syschk"/a02.root_Owner.log"
a03=$com_syschk"/a03.su_wheel.log"
a04=$com_syschk"/a04.gshadow.log"
a05=$com_syschk"/a05.lastlog.log"
a06=$com_syschk"/a06.fail_login_history.log"
a07=$com_syschk"/a07.online_account.log"
a08=$com_syschk"/a08.root_user_bash_history.log"


# File Directory
f01=$com_syschk"/f01.passwd_shadow_file_permission.log"
f02=$com_syschk"/f02.hosts_xinetd_rsyslog_service_permission.log"
f03=$com_syschk"/f03.nouser.log"
f04=$com_syschk"/f04.setuid_config.log"
f05=$com_syschk"/f05.abnormal_file.log"
f06=$com_syschk"/f06.hiden_file.log"

# Network
n01=$com_syschk"/n01.ipaddr_sniffer_ARP.log"
n02=$com_syschk"/n02.open_session.log"
n03=$com_syschk"/n03.router_table.log"
n04=$com_syschk"/n04.secure_terminal(ssh).log"
n05=$com_syschk"/n05.Banner.log"

# Process
p01=$com_syschk"/p01.process_tree.log"
p02=$com_syschk"/p02.process.log"
p03=$com_syschk"/p03.open_files.log"
p04=$com_syschk"/p04.cpu.log"

# System
s01=$com_syschk"/s01.uptime.log"
s02=$com_syschk"/s02.kernel_version.log"
s03=$com_syschk"/s03.memory.log"
s04=$com_syschk"/s04.hdd_disk_partition.log"
s05=$com_syschk"/s05.umask.log"
s06=$com_syschk"/s06.env.log"
s07=$com_syschk"/s07.rootkit_check.log"
s08=$com_syschk"/s08.start_program.log"
s09=$com_syschk"/s09.system_timer.log"
s10=$com_syschk"/s10.crontab_schedule.log"
s11=$com_syschk"/s11.cmd_permission.log"

# Report
report=$com_syschk"/System_Report.log"


# Version 2.0
# Suspicious Process
p05=$com_syschk"/p05.suspicious_process.log"
# Suspicious File
f07=$com_syschk"/f07.suspicious_file.log"
# Suspicious Pipe
pi01=$com_syschk"/pi01.suspicious_pipe.log"
# Suspicious Log
l01=$com_syschk"/l01.suspicious_log.log"
# Schedule
s12=$com_syschk"/s10.at_systemctl_schedule.log"




#########################################
sys_check(){
#########################################

######################
# Account
######################

echo -e "\033[1;36m============================================"
echo -e "* Account"
echo -e "============================================\033[0;0m"
echo "* 1. Unused Account"
echo "======================================================================"           >> $a01
echo " 1. Unused Account"                                                               >> $a01
echo "======================================================================"           >> $a01
echo "Check> Unused Account, Commented & Deleted The Line"                              >> $a01
echo "----------------------------------------------------------------------"           >> $a01
echo "# cat /etc/passwd "                                                               >> $a01
if [ -f /etc/passwd ]
  then
    cat /etc/passwd                                                                     >> $a01
    echo "----------------------------------------------------------------------"       >> $a01
  else
    echo "File Not Found"                                                               >> $a01
    echo "----------------------------------------------------------------------"       >> $a01
fi
echo                                                                                    >> $a01

echo "* 2. root owner check(UID=0)"
    echo "======================================================================"       >> $a02
    echo " 2. root owner check(uid value 0) "                                           >> $a02
    echo "======================================================================"       >> $a02
    echo "Check> except for root, Account check(UID=0)"                                 >> $a02
    echo "----------------------------------------------------------------------"       >> $a02
echo "# cat /etc/passwd | grep \":0:\""                                                 >> $a02
if [ -f /etc/passwd ]
  then
    cat /etc/passwd | grep ":0:"                                                        >> $a02
    echo "----------------------------------------------------------------------"       >> $a02
  else
    echo "File Not Found"                                                               >> $a02
    echo "----------------------------------------------------------------------"       >> $a02
fi
echo                                                                                    >> $a02

echo "* 3. su Command Restriction"
    echo "======================================================================"       >> $a03
    echo " 3.1. su Command Restriction"                                                 >> $a03
    echo "======================================================================"       >> $a03
    echo "Check> Command  Permissions '-rwsr-x---' - Normal"                            >> $a03
    echo "----------------------------------------------------------------------"       >> $a03
echo "# ls -al /bin/su "                                                                >> $a03
if [ -f /bin/su ]
  then
    ls -al /bin/su                                                                      >> $a03
    echo "----------------------------------------------------------------------"       >> $a03
  else
    echo "File Not Found"                                                               >> $a03
    echo "----------------------------------------------------------------------"       >> $a03
fi
echo                                                                                    >> $a03

    echo "======================================================================"       >> $a03
    echo " 3.2. Wheel Group "                                                           >> $a03
    echo "======================================================================"       >> $a03
    echo "Check> wheel Group, su Command to add the account - Normal "                  >> $a03
    echo "----------------------------------------------------------------------"       >> $a03
echo "# cat /etc/group | grep wheel "                                                   >> $a03
if [ -f /etc/group ]
  then
    cat /etc/group | grep wheel                                                         >> $a03
    echo "----------------------------------------------------------------------"       >> $a03
  else
    echo "File Not Found"                                                               >> $a03
    echo "----------------------------------------------------------------------"       >> $a03
fi
echo                                                                                    >> $a03
																																			  
echo "* 4. gshadow"
    echo "======================================================================"       >> $a04
    echo " 4. gshadow "                                                                 >> $a04
    echo "======================================================================"       >> $a04
    echo "Check> Unused account "                                                       >> $a04
    echo "----------------------------------------------------------------------"       >> $a04
echo "# cat /etc/gshadow "                                                              >> $a04
if [ -f /etc/gshadow ]
  then
    cat /etc/gshadow                                                                    >> $a04
    echo "----------------------------------------------------------------------"       >> $a04
  else
    echo "File Not Found"                                                               >> $a04
    echo "----------------------------------------------------------------------"       >> $a04
fi
echo                                                                                    >> $a04

echo "* 5. System Account History"
    echo "======================================================================"       >> $a05
    echo " 5.1. Last Account - last"                                                    >> $a05
    echo "======================================================================"       >> $a05
    echo "Check> Do not use Account history. "                                          >> $a05
    echo "----------------------------------------------------------------------"       >> $a05
echo "# last"                                                                           >> $a05
if [ `last | wc -l` -ge 1 ]
  then
    last                                                                                >> $a05
    echo "----------------------------------------------------------------------"       >> $a05
  else
    echo "Not Found"                                                                    >> $a05
    echo "----------------------------------------------------------------------"       >> $a05
fi
echo                                                                                    >> $a05

    echo "======================================================================"       >> $a05
    echo " 5.2. Last Account - lastlog"                                                 >> $a05
    echo "======================================================================"       >> $a05
    echo "Check> Do not use Account history. "                                          >> $a05
    echo "----------------------------------------------------------------------"       >> $a05
echo "# lastlog"                                                                        >> $a05
if [ `lastlog | wc -l` -ge 1 ]
  then
    lastlog                                                                             >> $a05
    echo "----------------------------------------------------------------------"       >> $a05
  else
    echo "Not Found"                                                                    >> $a05
    echo "----------------------------------------------------------------------"       >> $a05
fi
echo                                                                                    >> $a05

echo "* 6. Failed Login Account"
    echo "======================================================================"       >> $a06
    echo " 6. Failed Login Account "                                                    >> $a06
    echo "======================================================================"       >> $a06
    echo "Check> Failed Login Account "                                                 >> $a06
    echo "----------------------------------------------------------------------"       >> $a06
echo "# lastb "                                                                         >> $a06
if [ `lastb | wc -l` -ge 1 ]
  then
    lastb                                                                               >> $a06
    echo "----------------------------------------------------------------------"       >> $a06
  else
    echo "Not Found"                                                                    >> $a06
    echo "----------------------------------------------------------------------"       >> $a06
fi
echo                                                                                    >> $a06

echo "* 7. Online Account"
    echo "======================================================================"       >> $a07
    echo " 7. Online Account "                                                          >> $a07
    echo "======================================================================"       >> $a07
    echo "Check> Unknown Online-Account "                                               >> $a07
    echo "----------------------------------------------------------------------"       >> $a07
echo "# w "                                                                             >> $a07
if [ `w | wc -l` -ge 1 ]
  then
    w                                                                                   >> $a07
    echo "----------------------------------------------------------------------"       >> $a07
  else
    echo "Not Found"                                                                    >> $a07
    echo "----------------------------------------------------------------------"       >> $a07
fi
echo                                                                                    >> $a07

echo "* 8. Bash Shell History"
    echo "======================================================================"       >> $a08
    echo " 8.1. root Bash Shell History "                                               >> $a08
    echo "======================================================================"       >> $a08
    echo "Check> Abnormal Command "                                                     >> $a08
    echo "----------------------------------------------------------------------"       >> $a08
echo "# cat /root/.bash_history "                                                       >> $a08
if [ -f /root/.bash_history ]
  then
    cat /root/.bash_history                                                             >> $a08
    echo "----------------------------------------------------------------------"       >> $a08
  else
    echo "File Not Found"                                                               >> $a08
    echo "----------------------------------------------------------------------"       >> $a08
fi
echo                                                                                    >> $a08

homedir=`ls /home`
num="2"
for user in $homedir
    do
      echo "======================================================================"     >> $a08
      echo " 8.$num. $user User Bash Shell History "                                    >> $a08
      echo "======================================================================"     >> $a08
      echo "Check> Abnormal Command "                                                   >> $a08
      echo "----------------------------------------------------------------------"     >> $a08
  echo "# cat /home/$user/.bash_history"                                                >> $a08
  if [ -f /home/$user/.bash_history ] 
      then
          cat /home/$user/.bash_history                                                 >> $a08
          echo "----------------------------------------------------------------------" >> $a08
          num="`expr $num + 1`"
      else
          echo " File Not Found"                                                        >> $a08
          echo "----------------------------------------------------------------------" >> $a08
fi
done
echo                                                                                    >> $a08


######################
# File Directory
######################
echo -e "\033[1;36m============================================"
echo -e "* File Directory "
echo -e "============================================\033[0;0m"

echo "* 1. passwd, shadow, group File Permissions"
    echo "======================================================================"       >> $f01
    echo " 1.1. passwd File"                                                            >> $f01
    echo "======================================================================"       >> $f01
    echo "Check> File Permissions '-rw-r--r--' - Normal"                                >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
echo "# ls -al /etc/passwd "                                                            >> $f01
if [ -f /etc/passwd ]
  then
    ls -al /etc/passwd                                                                  >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
  else
    echo "File Not Found"                                                               >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
fi
echo                                                                                    >> $f01

    echo "======================================================================"       >> $f01 
    echo " 1.2. shadow File"                                                            >> $f01
    echo "======================================================================"       >> $f01 
    echo "Check> File Permissions '-r--------', '----------' - Normal"                  >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
echo "# ls -al /etc/shadow "                                                            >> $f01	
if [ -f /etc/shadow ]
  then
    ls -al /etc/shadow                                                                  >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
  else
    echo "File Not Found"                                                               >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
fi
echo                                                                                    >> $f01

    echo "======================================================================"       >> $f01 
    echo " 1.3 group File"                                                              >> $f01
    echo "======================================================================"       >> $f01
    echo "Check> File Permissions '-rw-r--r--', '-r--------' - Normal"                  >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
echo "# ls -al /etc/group"                                                              >> $f01
if [ -f /etc/group ]
  then
    ls -al /etc/group                                                                   >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
  else
 
    echo "File Not Found"                                                               >> $f01
    echo "----------------------------------------------------------------------"       >> $f01
fi
echo                                                                                    >> $f01

echo "* 2. hosts, xinetd.conf, rsyslog.conf File Permissions"
    echo "======================================================================"       >> $f02
    echo " 2.1. hosts File"                                                             >> $f02
    echo "======================================================================"       >> $f02
    echo "Check> File Permissions '-rw-r--r--' - Normal"                                >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
echo "# ls -al /etc/hosts"                                                              >> $f02
if [ -f /etc/hosts ]
  then
    ls -al /etc/hosts                                                                   >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
  else
    echo "File Not Found"                                                               >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
fi
echo                                                                                    >> $f02

    echo "======================================================================"       >> $f02 
    echo " 2.2. xinetd File"                                                            >> $f02
    echo "======================================================================"       >> $f02 
    echo "Check> File Permissions '-r--------' - Normal"                                >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
echo "# ls -al /etc/xinetd.conf"                                                        >> $f02	
if [ -f /etc/xinetd.conf ]
  then
    ls -al /etc/xinetd.conf                                                             >> $f02
	echo "----------------------------------------------------------------------"         >> $f02
  else
    echo "File Not Found"                                                               >> $f02
	echo "----------------------------------------------------------------------"         >> $f02
fi
echo                                                                                    >> $f02

    echo "======================================================================"       >> $f02 
    echo " 2.3 rsyslog.conf File"                                                       >> $f02
    echo "======================================================================"       >> $f02
    echo "Check> File Permissions '-rw-r--r--' - Normal"                                >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
echo "# ls -al /etc/rsyslog.conf"                                                       >> $f02
if [ -f /etc/rsyslog.conf ]
  then
    ls -al /etc/rsyslog.conf                                                            >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
  else
    echo "File Not Found"                                                               >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
fi
echo                                                                                    >> $f02

    echo "======================================================================"       >> $f02 
    echo " 2.4 services File"                                                           >> $f02
    echo "======================================================================"       >> $f02
    echo "Check> File Permissions '-rw-r--r--' - Normal"                                >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
echo "# ls -al /etc/services"                                                           >> $f02
if [ -f /etc/services ]
  then
    ls -al /etc/services                                                                >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
  else
 
    echo "File Not Found"                                                               >> $f02
    echo "----------------------------------------------------------------------"       >> $f02
fi
echo                                                                                    >> $f02

echo "* 3. No Owner File "
    echo "======================================================================"       >> $f03
    echo " 3. No Owner File"                                                            >> $f03
    echo "======================================================================"       >> $f03
    echo "Check> No Owner File check"                                                   >> $f03
    echo "----------------------------------------------------------------------"       >> $f03
echo "# find / -nouser -o -nogroup -print 2>/dev/null"                                  >> $f03
if [ `which find | wc -l` -eq 1 ]
  then
    find / -nouser -o -nogroup -print 2>/dev/null                                       >> $f03
    echo "----------------------------------------------------------------------"       >> $f03
  else
    echo "File Not Found"                                                               >> $f03
	echo "----------------------------------------------------------------------"         >> $f03
fi
echo                                                                                    >> $f03

echo "* 4. Special File Permissions(SetUID, SetGID, Sticky Bit)"
    echo "======================================================================"       >> $f04
    echo " 4.1. SetUID set File"                                                        >> $f04
    echo "======================================================================"       >> $f04
    echo "Check> Check"                                                                 >> $f04
    echo "----------------------------------------------------------------------"       >> $f04
echo "# find / -user root -perm -4000 -print -xdev"                                     >> $f04
if [ `which find | wc -l` -eq 1 ]
  then
    find / -user root -perm -4000 -print -xdev 2>/dev/null                              >> $f04
    echo "----------------------------------------------------------------------"       >> $f04
  else
    echo "File Not Found"                                                               >> $f04
    echo "----------------------------------------------------------------------"       >> $f04
fi
echo                                                                                    >> $f04

    echo "======================================================================"       >> $f04 
    echo " 4.2. SetGID set File"                                                        >> $f04
    echo "======================================================================"       >> $f04
echo "# find / -perm -2000 -print -xdev"                                                >> $f04	
if [ `which find | wc -l` -eq 1 ]
  then
    find / -perm -2000 -print -xdev 2>/dev/null                                         >> $f04
    echo "----------------------------------------------------------------------"       >> $f04
  else
    echo "File Not Found"                                                               >> $f04
    echo "----------------------------------------------------------------------"       >> $f04
fi
echo                                                                                    >> $f04

    echo "======================================================================"       >> $f04 
    echo " 4.3 Sticky Bit set File"                                                     >> $f04
    echo "======================================================================"       >> $f04
echo "# find / -perm -1000 -print -xdev"                                                >> $f04
if [ `which find | wc -l` -eq 1 ]
  then
    find / -perm -1000 -print -xdev 2>/dev/null                                         >> $f04
    echo "----------------------------------------------------------------------"       >> $f04
  else
 
    echo "File Not Found"                                                               >> $f04
    echo "----------------------------------------------------------------------"       >> $f04
fi
echo                                                                                    >> $f04

echo "* 5. /dev, /tmp file Check "
    echo "======================================================================"       >> $f05
    echo " 5.1. /dev File Check "                                                       >> $f05
    echo "======================================================================"       >> $f05
    echo "Check> abnormal File in /dev "                                                >> $f05
    echo "----------------------------------------------------------------------"       >> $f05
echo "# find /dev -type f -print | grep -v \"MAKEDEV\""                                 >> $f05
if [ `which find | wc -l` -eq 1 ]
  then
    find /dev -type f -print | grep -v "MAKEDEV"                                        >> $f05
    echo "----------------------------------------------------------------------"       >> $f05
  else
    echo "Command Not Found"                                                            >> $f05
    echo "----------------------------------------------------------------------"       >> $f05	
fi
echo                                                                                    >> $f05

    echo "======================================================================"       >> $f05
    echo " 5.2. /tmp File Check "                                                       >> $f05
    echo "======================================================================"       >> $f05
echo "# find /tmp -type f -print "                                                      >> $f05
if [ `which find | wc -l` -eq 1 ]
  then
    find /tmp -type f -print                                                            >> $f05
    echo "----------------------------------------------------------------------"       >> $f05
  else
    echo "Command Not Found"                                                            >> $f05
    echo "----------------------------------------------------------------------"       >> $f05
fi
echo                                                                                    >> $f05

echo "* 6. /dev, /tmp, /home Hiden"
    echo "======================================================================"       >> $f06
    echo " 6.1. Hiden File in /dev "                                                    >> $f06
    echo "======================================================================"       >> $f06
    echo "Check> Hidden File check"	                                                    >> $f06
    echo "----------------------------------------------------------------------"       >> $f06
echo "# find /dev -name \".*\" -print"                                                  >> $f06
if [ `which find | wc -l` -eq 1 ]
  then
    find /dev -name ".*" -print  | cat -v                                               >> $f06
    echo "----------------------------------------------------------------------"       >> $f06
  else
    echo "Command Not Found"                                                            >> $f06
    echo "----------------------------------------------------------------------"       >> $f06
fi 
echo                                                                                    >> $f06
    
    echo "======================================================================"       >> $f06
    echo " 6.2. Hiden File in /tmp "                                                    >> $f06
    echo "======================================================================"       >> $f06
echo "# find /tmp -name \".*\" -print"                                                  >> $f06
if [ `which find | wc -l` -eq 1 ]
  then
    find /tmp -name ".*" -print  | cat -v                                               >> $f06
    echo "----------------------------------------------------------------------"       >> $f06	 
  else
    echo "Command Not Found"                                                            >> $f06
    echo "----------------------------------------------------------------------"       >> $f06
fi 
echo                                                                                    >> $f06
    echo "======================================================================"       >> $f06
    echo " 6.3. Hiden File in /home "                                                   >> $f06
    echo "======================================================================"       >> $f06
echo "# find /home -name \".*\" -print"                                                 >> $f06
if [ `which find | wc -l` -eq 1 ]
  then
     find /home -name ".*" -print  | cat -v                                             >> $f06
    echo "----------------------------------------------------------------------"       >> $f06
  else
    echo "Command Not Found"                                                            >> $f06
    echo "----------------------------------------------------------------------"       >> $f06
fi
echo                                                                                    >> $f06

echo "* 7. Suspicious File"
    echo "======================================================================"       >> $f07
    echo " 7.1. Immutable File "                                                        >> $f07
    echo "======================================================================"       >> $f07
    echo "Check> Search Immitable File"	                                                >> $f07
    echo "----------------------------------------------------------------------"       >> $f07
echo "# lsattr / -R -2> /dev/null | grep “——i”"                                         >> $f07
    find /dev -name ".*" -print  | cat -v                                               >> $f07
    echo "----------------------------------------------------------------------"       >> $f07
echo                                                                                    >> $f06
    
    echo "======================================================================"       >> $f07
    echo " 7.2. Executable file with hidden attribute "                                 >> $f07
    echo "======================================================================"       >> $f07
    echo "Check> Search Hidden executable file"	                                        >> $f07
    echo "----------------------------------------------------------------------"       >> $f07
echo "# find / -name “.*” -exec file -p ‘{}’ \; | grep ELF"                             >> $f07
    find / -name “.*” -exec file -p ‘{}’ \; 2> /dev/null | grep ELF                     >> $f07
    echo "----------------------------------------------------------------------"       >> $f07
echo                                                                                    >> $f06

    echo "======================================================================"       >> $f07
    echo " 7.3. create or modify file one day ago"                                      >> $f07
    echo "======================================================================"       >> $f07
    echo "Check> Search modify file one day ago"	                                >> $f07
    echo "----------------------------------------------------------------------"       >> $f07
echo "# find / -mtime -1"                                                               >> $f07
    find / -mtime -1 2> /dev/null                                                       >> $f07
    echo "----------------------------------------------------------------------"       >> $f07

    echo "======================================================================"       >> $f07
    echo " 7.4. Suspicious History file"                                                >> $f07
    echo "======================================================================"       >> $f07
    echo "Check> Search suspicious history file"	                                >> $f07
    echo "----------------------------------------------------------------------"       >> $f07
echo "# ls -alR / 2> /dev/null | grep .*history | grep null"                            >> $f07
    ls -alR / 2> /dev/null | grep .*history | grep null                                 >> $f07
    echo "----------------------------------------------------------------------"       >> $f07

######################
# Pipe
######################
echo -e "\033[1;36m============================================"
echo -e "* Pipe "
echo -e "============================================\033[0;0m"

echo "* 1. Suspicious Pipe"
    echo "======================================================================"       >> $pi01
    echo " 1. List all pipe "                                                           >> $pi01
    echo "======================================================================"       >> $pi01
echo "# find / -type p"                                                                 >> $pi01
    find / -type p 2> /dev/null                                                         >> $pi01
    echo "----------------------------------------------------------------------"       >> $pi01
echo                                                                                    >> $pi01


######################
# Log
######################
echo -e "\033[1;36m============================================"
echo -e "* Log "
echo -e "============================================\033[0;0m"

echo "* 1. Check Log"
    echo "======================================================================"       >> $l01
    echo " 1.1 Login State "                                                            >> $l01
    echo "======================================================================"       >> $l01
echo "# utmpdump /var/run/utmp"                                                         >> $l01
    utmpdump /var/run/utmp                                                              >> $l01
    echo "----------------------------------------------------------------------"       >> $l01
echo                                                                                    >> $l01

    echo "======================================================================"       >> $l01
    echo " 1.2 Logout State "                                                           >> $l01
    echo "======================================================================"       >> $l01
echo "# utmpdump /var/log/wtmp"                                                         >> $l01
    utmpdump /var/log/wtmp                                                              >> $l01
    echo "----------------------------------------------------------------------"       >> $l01
echo                                                                                    >> $l01

    echo "======================================================================"       >> $l01
    echo " 1.3 Login fail State "                                                       >> $l01
    echo "======================================================================"       >> $l01
echo "# utmpdump /var/log/btmp"                                                         >> $l01
    utmpdump /var/log/btmp                                                              >> $l01
    echo "----------------------------------------------------------------------"       >> $l01
echo                                                                                    >> $l01

    echo "======================================================================"       >> $l01
    echo " 1.4 find size 0 logfile "                                                    >> $l01
    echo "======================================================================"       >> $l01
echo "# find /var/log -size 0 -exec ls -al {} \;"                                       >> $l01
    find /var/log -size 0 -exec ls -al {} \;                                            >> $l01
    echo "----------------------------------------------------------------------"       >> $l01
echo                                                                                    >> $l01




######################
# Network
######################
echo -e "\033[1;36m============================================"
echo -e "* Network "
echo -e "============================================\033[0;0m"

echo "* 1. IP Address & Sniffer & ARP Spoopoing"
    echo "======================================================================"       >> $n01
    echo " 1.1. IP Address "                                                            >> $n01
    echo "======================================================================"       >> $n01
echo "# ifconfig"                                                                       >> $n01
if [ `ifconfig | wc -l` -ge 1 ]                                                
  then
    ifconfig                                                                            >> $n01
    echo "----------------------------------------------------------------------"       >> $n01
  else
    echo "Fine Not Found"                                                               >> $n01
    echo "----------------------------------------------------------------------"       >> $n01
fi
echo                                                                                    >> $n01

    echo "======================================================================"       >> $n01
    echo " 1.2. Sniffing "                                                              >> $n01
    echo "======================================================================"       >> $n01
    echo "Check> Promiscous Mode "                                                      >> $n01
    echo "----------------------------------------------------------------------"       >> $n01
echo "# ifconfig | grep \"PROMIS\" "                                                    >> $n01
if [ `ifconfig | grep "PROMIS" | wc -l` -ge 1 ]
  then
    echo "Sniffer Mode "                                                                >> $n01
    ifconfig | grep "PROMIS"                                                            >> $n01
    echo "----------------------------------------------------------------------"       >> $n01
  else
    echo "No Sniffer Mode "                                                             >> $n01
    echo "----------------------------------------------------------------------"       >> $n01	
fi
echo                                                                                    >> $n01

    echo "======================================================================"       >> $n01
    echo " 1.3. ARP "                                                                   >> $n01
    echo "======================================================================"       >> $n01
    echo "Check> Duplicate of (IP, MAC) address in MAC-IP binding - Spooping "          >> $n01
    echo "----------------------------------------------------------------------"       >> $n01
echo "# arp -a "                                                                        >> $n01
if [ `arp -a | wc -l` -ge 1 ]                                                
  then
    arp -a                                                                              >> $n01
    echo "----------------------------------------------------------------------"       >> $n01	
  else
    echo " Not Found"                                                                   >> $n01
echo "--------------------------------------------------------------------"             >> $n01
fi
echo                                                                                    >> $n01

echo "* 2. Open Port"
    echo "======================================================================"       >> $n02
    echo " 2. Open Port  "                                                              >> $n02
    echo "======================================================================"       >> $n02
    echo "Check> Abnormal Port"                                                         >> $n02
    echo "----------------------------------------------------------------------"       >> $n02
echo "# netstat -anp"                                                                   >> $n02
if [ `which netstat | wc -l` -ge 1 ]
  then
    netstat -anp								                                        >> $n02
    echo "----------------------------------------------------------------------"       >> $n02
  else
    echo " netstat Command Not Found"                                                   >> $n02
    echo "----------------------------------------------------------------------"       >> $n02  
fi
echo                                                                                    >> $n02

echo "* 3. Router Table"
    echo "======================================================================"       >> $n03
    echo " 3. Router Table"                                                             >> $n03
    echo "======================================================================"       >> $n03
    echo "Check> Abnormal Port"                                                         >> $n03
    echo "----------------------------------------------------------------------"       >> $n03
echo "# netstat -rn"                                                                    >> $n03
if [ `which netstat | wc -l` -ge 1 ]
  then
    netstat -rn								                                            >> $n03
    echo "----------------------------------------------------------------------"       >> $n03
  else
    echo " netstat Command Not Found"                                                   >> $n03
    echo "----------------------------------------------------------------------"       >> $n03  
fi
echo                                                                                    >> $n03


echo "* 4. Secure Terminal(SSH)"
    echo "======================================================================"       >> $n04
    echo " 4. Secure Terminal (SSH) "                                                   >> $n04
    echo "======================================================================"       >> $n04
    echo "Check> SSH Check"                                                             >> $n04
    echo "----------------------------------------------------------------------"       >> $n04
echo "# netstat -anp | grep "LISTEN" | egrep \":(22|23)\""                              >> $n04
if [ `netstat -anp | grep "LISTEN" | egrep ":(22|23)" | wc -l` -eq 1 ]
  then
    netstat -anp | grep "LISTEN" | egrep ":(22|23)"                                     >> $n04
    echo "----------------------------------------------------------------------"       >> $n04
   else
    echo " Terminal Not Found"                                                          >> $n04
    echo "----------------------------------------------------------------------"       >> $n04
fi
echo                                                                                    >> $n04

echo "* 5. System Banner Check"
    echo "======================================================================"       >> $n05
    echo " 5.1. System Banner - issue "                                                 >> $n05
    echo "======================================================================"       >> $n05
    echo "Check> Modified System Banner Information"                                    >> $n05
    echo "----------------------------------------------------------------------"       >> $n05
echo "# cat /etc/issue "                                                                >> $n05
if [ -f /etc/issue ]
  then
    cat /etc/issue                                                                      >> $n05
    echo "----------------------------------------------------------------------"       >> $n05
  else
    echo " /etc/issue File Not Found."                                                  >> $n05
    echo "----------------------------------------------------------------------"       >> $n05	
fi
echo                                                                                    >> $n05

    echo "======================================================================"       >> $n05
    echo " 5.2. System Banner - issue.net "                                             >> $n05
    echo "======================================================================"       >> $n05
    echo "Check> Modified System Banner Information"                                    >> $n05
    echo "----------------------------------------------------------------------"       >> $n05
echo "# cat /etc/issue.net "                                                            >> $n05
if [ -f /etc/issue.net ]
  then
    cat /etc/issue.net                                                                  >> $n05
    echo "----------------------------------------------------------------------"       >> $n05	 
  else
    echo " /etc/issue.net File Not Found."                                              >> $n05
    echo "----------------------------------------------------------------------"       >> $n05    
fi
echo                                                                                    >> $n05

    echo "======================================================================"       >> $n05
    echo " 5.3. System Banner - motd "                                                  >> $n05
    echo "======================================================================"       >> $n05
    echo "Check> Modified System Banner Information"                                    >> $n05
    echo "----------------------------------------------------------------------"       >> $n05
echo "# cat /etc/motd "                                                                 >> $n05
if [ -f /etc/motd ]
  then
     cat /etc/motd                                                                      >> $n05
   echo "----------------------------------------------------------------------"        >> $n05
  else
    echo " /etc/motd File Not Found."                                                   >> $n05
    echo "----------------------------------------------------------------------"       >> $n05
fi 
echo                                                                                    >> $n05



######################
# Process
######################
echo -e "\033[1;36m============================================"
echo -e "* Process "
echo -e "============================================\033[0;0m"

echo "* 1. Running Process Tree"
    echo "======================================================================"       >> $p01
    echo " 1. Running Process Tree"                                                     >> $p01
    echo "======================================================================"       >> $p01
echo "# pstree -acpul"                                                                  >> $p01
if [ `which pstree | wc -l` -eq 1 ]
  then
    pstree -acpul                                                                       >> $p01
    echo "----------------------------------------------------------------------"       >> $p01
  else
    echo " pstree Command Not Found"                                                    >> $p01
    echo "----------------------------------------------------------------------"       >> $p01
fi
echo                                                                                    >> $p01

echo "* 2. Running Process List"
    echo "======================================================================"       >> $p02
    echo " 2. Running Process List"                                                     >> $p02
    echo "======================================================================"       >> $p02
echo "# ps auwxf"                                                                       >> $p02
if [ `which ps | wc -l` -eq 1 ]
  then
    ps auwxf                                                                            >> $p02
    echo "----------------------------------------------------------------------"       >> $p02
  else
    echo " ps Command Not Found"                                                        >> $p02
    echo "----------------------------------------------------------------------"       >> $p02
fi
echo                                                                                    >> $p02

echo "* 3. Open File List"
    echo "======================================================================"       >> $p03
    echo " 3. Open File List"                                                           >> $p03
    echo "======================================================================"       >> $p03
echo "# lsof -i"                                                                        >> $p03
if [ `which lsof | wc -l` -eq 1 ]
  then
    lsof -i                                                                             >> $p03
    echo "----------------------------------------------------------------------"       >> $p03
  else
    echo " lsof Command Not Found"                                                      >> $p03
    echo "----------------------------------------------------------------------"       >> $p03
fi
echo                                                                                    >> $p03

echo "* 4. CPU State"
    echo "======================================================================"       >> $p04
    echo " 4. CPU State"                                                                >> $p04
    echo "======================================================================"       >> $p04
echo "# top -n 1"                                                                       >> $p04
if [ `which top | wc -l` -eq 1 ]
  then
    top -n 1                                                                            >> $p04
    echo "----------------------------------------------------------------------"       >> $p04
  else
    echo " top Command Not Found"                                                       >> $p04
	echo                                                                                  >> $p04
    echo "----------------------------------------------------------------------"       >> $p04
fi
echo                                                                                    >> $p04

echo "* 5. Suspicious Process"
    echo "======================================================================"       >> $p05
    echo " 5-1. Run on the tmp directory "                                              >> $p05
    echo "======================================================================"       >> $p05
echo "Check >> Find Process that run on the tmp directory"                              >> $p05
    ls -alR /proc/*/cwd 2> /dev/null | grep tmp                                         >> $p05
    echo "----------------------------------------------------------------------"       >> $p05
echo                                                                                    >> $p05

    echo "======================================================================"       >> $p05
    echo " 5-2. Process which deleted file "                                            >> $p05
    echo "======================================================================"       >> $p05
echo "Check >> Find Process that run on the tmp directory"                              >> $p05
    ls -alR /proc/*/exe 2> /dev/null | grep deleted                                     >> $p05
    echo "----------------------------------------------------------------------"       >> $p05
echo                                                                                    >> $p05





######################
# File System
######################
echo -e "\033[1;36m============================================"
echo -e "* File system "
echo -e "============================================\033[0;0m"

echo "* 1. System UPTIME"
    echo "======================================================================"       >> $s01
    echo " 1.1. System UPTIME  "                                                        >> $s01
    echo "======================================================================"       >> $s01
    echo "Check> System UPTIME"                                                         >> $s01
    echo "----------------------------------------------------------------------"       >> $s01
echo "# uptime"                                                                         >> $s01
if [ `uptime | wc -l` -eq 1 ]
  then
    uptime                                                                              >> $s01
    echo "----------------------------------------------------------------------"       >> $s01
  else
    echo "Command Not Found"                                                            >> $s01
    echo "----------------------------------------------------------------------"       >> $s01
fi
echo                                                                                    >> $s01

echo "* 2. Kernel Version"
    echo "======================================================================"       >> $s02
	echo " 2. Kernel Version "                                                          >> $s02
    echo "======================================================================"       >> $s02
    echo "Check> Kernel Version"                                                        >> $s02
    echo "----------------------------------------------------------------------"       >> $s02
echo "# uname -a"                                                                       >> $s02
if [ `uname -a | wc -l` -eq 1 ]
  then
    uname -a                                                                            >> $s02
    echo "----------------------------------------------------------------------"       >> $s02
  else
    echo "Command Not Found"                                                            >> $s02
    echo "----------------------------------------------------------------------"       >> $s02	
fi
echo                                                                                    >> $s02

echo "* 3. Memory State"
    echo "======================================================================"       >> $s03
    echo " 3. Memory State "                                                            >> $s03
    echo "======================================================================"       >> $s03
    echo "Check> Overload Memory State, cpu id(=0) - Abnormal"                          >> $s03
    echo "----------------------------------------------------------------------"       >> $s03
echo "# vmstat 2 5 | awk '{now=strftime("%F %T"); print now,\"\",$0}'"                  >> $s03
if [ `vmstat | wc -l` -ge 1 ]
  then
    vmstat 2 5 | awk '{now=strftime("%F %T"); print now,"",$0}'                         >> $s03
    echo "----------------------------------------------------------------------"       >> $s03
  else
    echo "Command Not Found"                                                            >> $s03
    echo "----------------------------------------------------------------------"       >> $s03
fi
echo                                                                                    >> $s03

echo "* 4. HDD, Disk, Partition"
    echo "======================================================================"       >> $s04
    echo " 4.1. Disk Use "                                                              >> $s04
    echo "======================================================================"       >> $s04
    echo "Check> Disk Use"                                                              >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
echo "# df -h"                                                                          >> $s04
if [ `df -h | wc -l` -ge 1 ]
  then
    df -h                                                                               >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
  else
    echo "Command Not Found"                                                            >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
fi
echo                                                                                    >> $s04

    echo "======================================================================"       >> $s04
    echo " 4.2. Physical Disk Use "                                                     >> $s04
    echo "======================================================================"       >> $s04
    echo "Check> Physical Disk Use"                                                     >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
echo "# fdisk -l "                                                                      >> $s04
if [ `fdisk -l | wc -l` -ge 1 ]
  then
    fdisk -l                                                                            >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
  else
    echo "Command Not Found"                                                            >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
fi
echo                                                                                    >> $s04

    echo "======================================================================"       >> $s04
    echo " 4.3. Partition Use "                                                         >> $s04
    echo "======================================================================"       >> $s04
    echo "Check> Partition Use"                                                         >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
echo "# lsblk "                                                                         >> $s04
if [ `lsblk | wc -l` -ge 1 ]
  then
    lsblk                                                                               >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
  else
    echo "Command Not Found"                                                            >> $s04
    echo "----------------------------------------------------------------------"       >> $s04
fi
echo                                                                                    >> $s04

echo "* 5. umask"
    echo "======================================================================"       >> $s05
    echo " 5. umask "                                                                   >> $s05
    echo "======================================================================"       >> $s05
    echo "Check> umask Value 0022 - Normal"                                             >> $s05
    echo "----------------------------------------------------------------------"       >> $s05
echo "# umask "                                                                         >> $s05
if [ `umask | wc -l` -eq 1 ]
  then
    umask                                                                               >> $s05
    echo "----------------------------------------------------------------------"       >> $s05
  else
    echo "Command Not Found"                                                            >> $s05
    echo "----------------------------------------------------------------------"       >> $s05
fi
echo                                                                                    >> $s05

echo "* 6. System Enviroment Value"
    echo "======================================================================"       >> $s06
    echo " 6. System Enviroment Value "                                                 >> $s06
    echo "======================================================================"       >> $s06
    echo "Check> System Enviroment Valu "                                               >> $s06
    echo "----------------------------------------------------------------------"       >> $s06
echo "# printenv"                                                                       >> $s06
if [ `which printenv | wc -l` -eq 1 ]
  then
    printenv                                                                            >> $s06
    echo "----------------------------------------------------------------------"       >> $s06
  else
    echo " printenv Command Not Found"                                                  >> $s06
    echo "----------------------------------------------------------------------"       >> $s06
fi
echo                                                                                    >> $s06

echo "* 7. RootKit"
    echo "======================================================================"       >> $s07
    echo " 7.1. System Enviroment PATH "                                                >> $s07
    echo "======================================================================"       >> $s07
	echo "Check> System Enviroment Value, include \".\", \"::\" - Abnormal"             >> $s07
    echo "----------------------------------------------------------------------"       >> $s07
echo "# cat /etc/passwd "                                                               >> $s07
if [ `echo $PATH | wc -l` -ge 1 ]
  then
    echo $PATH                                                                          >> $s07
    echo "----------------------------------------------------------------------"       >> $s07
  else
    echo "No Data"                                                                      >> $s07
    echo "----------------------------------------------------------------------"       >> $s07	
fi
echo                                                                                    >> $s07

    echo "======================================================================"       >> $s07
    echo " 7.2. Chkrootkit Check "                                                      >> $s07
    echo "======================================================================"       >> $s07
echo "# chkrootkit "                                                                    >> $s07
if [ `which chkrootkit | wc -l` -eq 1 ]
  then
    chkrootkit | egrep -v "(nothing found|not infected|not found|not tested)"           >> $s07
	echo "----------------------------------------------------------------------"       >> $s07
  else
    echo "chkrootkit File Not Found"                                                    >> $s07
    echo "----------------------------------------------------------------------"       >> $s07	
fi
echo                                                                                    >> $s07

    echo "======================================================================"       >> $s07
    echo " 7.3. Rootkit Hunter Check "                                                  >> $s07
    echo "======================================================================"       >> $s07
echo "# rkhunter -c --sk "                                                              >> $s07
if [ `which rkhunter | wc -l` -eq 1 ]
  then
    rkhunter -c --sk | egrep -v "(OK|Not found|None found)"                             >> $s07
    echo "----------------------------------------------------------------------"       >> $s07
  else
    echo "rkhunter Not Install"                                                         >> $s07
    echo "----------------------------------------------------------------------"       >> $s07
fi
echo                                                                                    >> $s07

echo "* 8. Start Programs"
    echo "======================================================================"       >> $s08
    echo " 8.1. Start Programs "                                                        >> $s08
    echo "======================================================================"       >> $s08
    echo "Check> Start Programs Check"                                                  >> $s08
	echo "Check> Permission '-----w--w-' set - Abnormal"                                >> $s08
    echo "----------------------------------------------------------------------"       >> $s08
echo "# ls -al /etc/init.d/*"                                                           >> $s08
if [ `ls -al /etc/init.d/* | wc -l` -ge 1 ]
  then
    ls -al /etc/init.d/*                                                                >> $s08
    echo "----------------------------------------------------------------------"       >> $s08
  else
    echo " /etc/init.d/* File Not Found"                                                >> $s08
    echo "----------------------------------------------------------------------"       >> $s08
fi
echo                                                                                    >> $s08

    echo "======================================================================"       >> $s08
    echo " 8.2. Start Programs State"                                                   >> $s08
    echo "======================================================================"       >> $s08
    echo "Check> Start Programs State"                                                  >> $s08
    echo "----------------------------------------------------------------------"       >> $s08
echo "# chkconfig --list"                                                               >> $s08
if [ `which chkconfig | wc -l` -eq 1 ]
  then
    chkconfig --list 2>/dev/nell                                                        >> $s08
    echo "----------------------------------------------------------------------"       >> $s08
  else
    echo "chkconfig Command Not Found"                                                  >> $s08
    echo "----------------------------------------------------------------------"       >> $s08
fi
echo                                                                                    >> $s08

echo "* 9. System Timer"
    echo "======================================================================"       >> $s09
    echo " 9. System Timer "                                                            >> $s09
    echo "======================================================================"       >> $s09
    echo "Check> Abnormal System Timer "                                                >> $s09
    echo "----------------------------------------------------------------------"       >> $s09
echo "# systemctl list-unit-files --type=timer"                                         >> $s09
if [ `which systemctl | wc -l` -eq 1  ]
  then
    systemctl list-unit-files --type=timer                                              >> $s09
    echo "----------------------------------------------------------------------"       >> $s09
  else
    echo "systemctl Command Not Found"                                                  >> $s09
    echo "----------------------------------------------------------------------"       >> $s09
fi
echo                                                                                    >> $s09

echo "* 10. Crontab Schedule List"

    echo "======================================================================"       >> $s10
    echo " 10.1. root Crontab Schedule List "                                           >> $s10
    echo "======================================================================"       >> $s10
    echo "Check> Abnormal Command "                                                     >> $s10
    echo "----------------------------------------------------------------------"       >> $s10
echo "# crontab -u root -l"                                                             >> $s10
if [ `crontab -u root -l | wc -l` -ge 1 ] 
  then
    crontab -u root -l                                                                  >> $s10
    echo "----------------------------------------------------------------------"       >> $s10
  else
    echo " No Data"                                                                     >> $s10
    echo "----------------------------------------------------------------------"       >> $s10
fi
echo                                                                                    >> $s10

homedir=`ls /home`
num="2"
for user in $homedir
    do
      echo "======================================================================"     >> $s10
      echo " 10.$num. $user User Crontab Schedule List "                                >> $s10
      echo "======================================================================"     >> $s10
      echo "Check> Abnormal Command "                                                   >> $s10
      echo "----------------------------------------------------------------------"     >> $s10
  echo "# crontab -u $user -l"                                                          >> $s10
  if [ `crontab -u $user -l | wc -l` -ge 1 ] 
    then
        crontab -u $user -l | cat -v                                                    >> $s10
        echo "----------------------------------------------------------------------"   >> $s10
        num="`expr $num + 1`"
    else
        echo " No Data"                                                                 >> $s10
        echo "----------------------------------------------------------------------"   >> $s10
fi
done
echo                                                                                    >> $s10


echo "* 11. System Command Permission"
    echo "======================================================================"       >> $s11
    echo " 11. System Command Permission "                                              >> $s11
    echo "======================================================================"       >> $s11
    echo "Check> Permission '-rwxr-xr-x', '---x------' - Normal "                       >> $s11
    echo "Check> Permission '-----w--w-' set - Abnormal "                               >> $s11
    echo "----------------------------------------------------------------------"       >> $s11
#top
    if [ `which top | wc -l` -eq 1 ]
     then
      cmd=`which top`
      ls -al $cmd                                                                       >> $s11
     else
      echo "top Command Not Found"                                                      >> $s11
    fi
#pstree
    if [ `which pstree | wc -l` -eq 1 ]
     then
      cmd=`which pstree`
      ls -al $cmd                                                                       >> $s11
     else
      echo "pstree Command Not Found"                                                   >> $s11
    fi
#w
    if [ `which w | wc -l` -eq 1 ]
     then
      cmd=`which w`
      ls -al $cmd                                                                       >> $s11
     else
      echo "w Command Not Found"                                                        >> $s11
    fi
#ps
    if [ `which ps | wc -l` -eq 1 ]
     then
      cmd=`which ps`
      ls -al $cmd                                                                       >> $s11
     else
      echo "ps Command Not Found"                                                       >> $s11
    fi
#who
    if [ `which who | wc -l` -eq 1 ]
     then
      cmd=`which who`
      ls -al $cmd                                                                       >> $s11
     else
      echo "who Command Not Found"                                                      >> $s11
    fi
#find
    if [ `which find | wc -l` -eq 1 ]
     then
      cmd=`which find`
      ls -al $cmd                                                                       >> $s11
     else
      echo "find Command Not Found"                                                     >> $s11
    fi
#df
    if [ `which df | wc -l` -eq 1 ]
     then
      cmd=`which df`
      ls -al $cmd                                                                       >> $s11
     else
      echo "df Command Not Found"                                                       >> $s11
    fi
#netstat
    if [ `which netstat | wc -l` -eq 1 ]
     then
      cmd=`which netstat`
      ls -al $cmd                                                                      >> $s11
     else
      echo "netstat Command Not Found"                                                 >> $s11
    fi
#ifconfig
    if [ `which ifconfig | wc -l` -eq 1 ]
     then
      cmd=`which ifconfig`
      ls -al $cmd                                                                      >> $s11
     else
      echo "ifconfig Command Not Found"                                                >> $s11
    fi
#lsof
    if [ `which lsof | wc -l` -eq 1 ]
     then
      cmd=`which lsof`
      ls -al $cmd                                                                      >> $s11
     else
      echo "lsof Command Not Found"                                                    >> $s11
    fi
#make
    if [ `which make | wc -l` -eq 1 ]
     then
      cmd=`which make`
      ls -al $cmd                                                                      >> $s11
     else
      echo "make Command Not Found"                                                    >> $s11
    fi
#gcc
    if [ `which gcc | wc -l` -eq 1 ]
     then
      cmd=`which gcc`
      ls -al $cmd                                                                      >> $s11
     else
      echo "gcc Command Not Found"                                                     >> $s11
    fi       
#cc
    if [ `which cc | wc -l` -eq 1 ]
     then
      cmd=`which cc`
      ls -al $cmd                                                                      >> $s11
     else
      echo "cc Command Not Found"                                                      >> $s11
    fi   
#g++
    if [ -f /usr/bin/g++ ]
     then
       ls -al /usr/bin/g++                                                             >> $s11
     else
      echo "g++ Command Not Found"                                                     >> $s11
    fi   
#c++
    if [ -f /usr/bin/c++ ]
     then
      ls -al /usr/bin/c++                                                              >> $s11
     else
      echo "c++ Command Not Found"                                                     >> $s11
    fi

#finger
    if [ `which finger | wc -l` -eq 1 ]
     then
      cmd=`which finger`
      ls -al $cmd                                                                      >> $s11
     else
      echo "finger Command Not Found"                                                  >> $s11
    fi
#nslookup
    if [ `which nslookup | wc -l` -eq 1 ]
     then
      cmd=`which nslookup`
      ls -al $cmd                                                                      >> $s11
     else
      echo "nslookup Command Not Found"                                                >> $s11
    fi
#whereis
    if [ `which whereis | wc -l` -eq 1 ]
     then
      cmd=`which whereis`
      ls -al $cmd                                                                      >> $s11
     else
      echo "whereis Command Not Found"                                                 >> $s11
    fi
#rlog
    if [ `which rlog | wc -l` -eq 1 ]
     then
      cmd=`which rlog`
      ls -al $cmd                                                                      >> $s11
     else
      echo "rlog Command Not Found"                                                    >> $s11
    fi
#rlogin
    if [ `which rlogin | wc -l` -eq 1 ]
     then
      cmd=`which rlogin`
      ls -al $cmd                                                                      >> $s11
     else
      echo "rlogin Command Not Found"                                                  >> $s11
    fi
#which
    if [ `which which | wc -l` -eq 1 ]
     then
      cmd=`which which`
      ls -al $cmd                                                                      >> $s11
     else
      echo "which Command Not Found"                                                   >> $s11
    fi
#mail
    if [ `which mail | wc -l` -eq 1 ]
     then
      cmd=`which mail`
      ls -al $cmd                                                                      >> $s11
     else
      echo "mail Command Not Found"                                                    >> $s11
    fi
#hosts
    if [ `ls /etc/hosts | wc -l` -eq 1 ]
     then
      ls -al /etc/hosts                                                                >> $s11
     else
      echo "/etc/hosts File Not Found"                                                 >> $s11
    fi
#hosts.deny
    if [ `ls /etc/hosts.deny | wc -l` -eq 1 ]
     then
      ls -al /etc/hosts.deny                                                           >> $s11
     else
      echo "/etc/hosts.deny File Not Found "                                           >> $s11
    fi
#hosts.allow
    if [ `ls /etc/hosts.allow | wc -l` -eq 1 ]
     then
      ls -al /etc/hosts.allow                                                          >> $s11
     else
      echo "/etc/hosts.allow File Not Found "                                          >> $s11
    fi
#lynx
    if [ `which lynx | wc -l` -eq 1 ]
     then
      cmd=`which lynx`
      ls -al $cmd                                                                      >> $s11
     else
      echo "lynx Command Not Found"                                                    >> $s11
    fi
#wget
    if [ `which wget | wc -l` -eq 1 ]
     then
      cmd=`which wget`
      ls -al $cmd                                                                      >> $s11
     else
      echo "wget Command Not Found"                                                    >> $s11
    fi
#curl
    if [ `which curl | wc -l` -eq 1 ]
     then
      cmd=`which curl`
      ls -al $cmd                                                                      >> $s11
     else
      echo "curl Command Not Found"                                                    >> $s11
    fi    
    echo "======================================================================"      >> $s11
echo                                                                                   >> $s11


echo "* 12. Scheduled job list"
    echo "======================================================================"       >> $s12
    echo " 1.1 at "                                                                     >> $s12
    echo "======================================================================"       >> $s12
    if [ `which at | wc -l` -eq 1 ]
     then
echo "# atq"												>> $s12
      atq                                                                               >> $s12
     else
      echo "at Command Not Found"                                                       >> $s12
    fi
    echo "----------------------------------------------------------------------"       >> $s12
echo                                                                                    >> $s12

    echo "======================================================================"       >> $s12
    echo " 1.2 systemctl "                                                              >> $s12
    echo "======================================================================"       >> $s12
echo "# systemctl list-timers -all"                                                     >> $s12
    systemctl list-timers -all                                                          >> $s12
    echo "----------------------------------------------------------------------"       >> $s12
echo                                                                                    >> $s12


}

#########################################
create_report(){
#########################################
df="`date`" 
echo "====================================================="                           >> $report
echo "  SYSTEM CHECK TIME"                                                             >> $report
echo "-----------------------------------------------------"                           >> $report
echo " *  Start  - $ds"                                                                >> $report
echo " *  Finish - $df"                                                                >> $report
echo "====================================================="                           >> $report
echo                                                                                   >> $report
echo "----------------------------------------------------------------------"          >> $report
echo                                                                                   >> $report
echo "============================"                                                    >> $report
echo "  SYSTEM CHECK LIST"                                                             >> $report
echo "============================"                                                    >> $report
echo                                                                                   >> $report
echo                                                                                   >> $report

echo "[ACCOUNT]"                                                                       >> $report
echo "a01. Unused Account"                                                             >> $report
echo "a02. ROOT Owner (UID=0)"                                                         >> $report
echo "a03. su Command"                                                                 >> $report
echo "a04. gshadow"                                                                    >> $report
echo "a05. System Account History"                                                     >> $report
echo "a06. Failed Login Account "                                                      >> $report
echo "a07. Online Account"                                                             >> $report
echo "a08. Bash Shell History"                                                         >> $report
echo                                                                                   >> $report

echo "[FILE_DIRECTORY]"                                                                >> $report
echo "f01. passwd, shadow, group File Permissions"                                     >> $report
echo "f02. hosts, xinetd, rsyslog, service File Permissions"                           >> $report
echo "f03. nouser File"                                                                >> $report
echo "f04. Special File Permissions(SetUID, SetGID, Sticky Bit)"                       >> $report
echo "f05. Abnormal File in /dev, /tmp"                                                >> $report
echo "f06. Hidden File in /dev, /tmp, /home"                                           >> $report
echo                                                                                   >> $report

echo "[NETWORK SERVICE]"                                                               >> $report
echo "n01. IP Address & Sniffer & ARP Spoopoing"                                       >> $report
echo "n02. Open Port"                                                                  >> $report
echo "n03. Router Table"                                                               >> $report
echo "n04. Secure Terminal(SSH)"                                                       >> $report
echo "n05.  System Banner"                                                             >> $report
echo                                                                                   >> $report

echo "[PROCESS]"                                                                       >> $report
echo "p01. Running Procoess Tree"                                                      >> $report
echo "p02. Running Process List"                                                       >> $report
echo "p03. Open File List"                                                             >> $report
echo "p04. CPU State"                                                                  >> $report
echo                                                                                   >> $report

echo "[FILE SYSTEM]"                                                                   >> $report
echo "s01. Uptime"                                                                     >> $report
echo "s02. Kernerl Version"                                                            >> $report
echo "s03. Memory State"                                                               >> $report
echo "s04. HDD, Partitions"                                                            >> $report
echo "s05. umask"                                                                      >> $report
echo "s06. System Enviroment Value"                                                    >> $report
echo "s07. Rootkit"                                                                    >> $report
echo "s08. Start Programs"                                                             >> $report
echo "s09. System Timers"                                                              >> $report
echo "s10. Crontab Schedule"                                                           >> $report
echo "s11. System Command Permission"                                                  >> $report

echo                                                                                   >> $report
echo "----------------------------------------------------------------------"          >> $report
echo                                                                                   >> $report
echo                                                                                   >> $report
echo                                                                                   >> $report
echo "########################## "                                                     >> $report
echo "#  Account                 "                                                     >> $report
echo "########################## "                                                     >> $report
echo                                                                                   >> $report
cat $a01                                                                               >> $report
echo                                                                                   >> $report
cat $a02                                                                               >> $report
echo                                                                                   >> $report
cat $a03                                                                               >> $report
echo                                                                                   >> $report
cat $a04                                                                               >> $report
echo                                                                                   >> $report
cat $a05                                                                               >> $report
echo                                                                                   >> $report
cat $a06                                                                               >> $report
echo                                                                                   >> $report
cat $a07                                                                               >> $report
echo                                                                                   >> $report
cat $a08                                                                               >> $report
echo                                                                                   >> $report

echo                                                                                   >> $report
echo "########################## "                                                     >> $report
echo "#  FILE & DIRECTORY        "                                                     >> $report
echo "########################## "                                                     >> $report
echo                                                                                   >> $report
cat $f01                                                                               >> $report
echo                                                                                   >> $report
cat $f02                                                                               >> $report
echo                                                                                   >> $report
cat $f03                                                                               >> $report
echo                                                                                   >> $report
cat $f04                                                                               >> $report
echo                                                                                   >> $report
cat $f05                                                                               >> $report
echo                                                                                   >> $report
cat $f06                                                                               >> $report
echo                                                                                   >> $report
cat $f07                                                                               >> $report
echo                                                                                   >> $report

echo                                                                                   >> $report
echo "########################## "                                                     >> $report
echo "#  NETWORD SERVICE         "                                                     >> $report
echo "########################## "                                                     >> $report
echo                                                                                   >> $report
cat $n01                                                                               >> $report
echo                                                                                   >> $report
cat $n02                                                                               >> $report
echo                                                                                   >> $report
cat $n03                                                                               >> $report
echo                                                                                   >> $report
cat $n04                                                                               >> $report
echo                                                                                   >> $report
cat $n05                                                                               >> $report
echo                                                                                   >> $report

echo                                                                                   >> $report
echo "########################## "                                                     >> $report
echo "#  PROCESS                 "                                                     >> $report
echo "########################## "                                                     >> $report
echo                                                                                   >> $report
cat $p01                                                                               >> $report
echo                                                                                   >> $report
cat $p02                                                                               >> $report
echo                                                                                   >> $report
cat $p03                                                                               >> $report
echo                                                                                   >> $report
cat $p04                                                                               >> $report
echo                                                                                   >> $report
echo                                                                                   >> $report
cat $p05                                                                               >> $report
echo                                                                                   >> $report

echo                                                                                   >> $report
echo "########################## "                                                     >> $report
echo "#  FILE SYSTEM             "                                                     >> $report
echo "########################## "                                                     >> $report
echo                                                                                   >> $report
cat $s01                                                                               >> $report
echo                                                                                   >> $report
cat $s02                                                                               >> $report
echo                                                                                   >> $report
cat $s03                                                                               >> $report
echo                                                                                   >> $report
cat $s04                                                                               >> $report
echo                                                                                   >> $report
cat $s05                                                                               >> $report
echo                                                                                   >> $report
cat $s06                                                                               >> $report
echo                                                                                   >> $report
cat $s07                                                                               >> $report
echo                                                                                   >> $report
cat $s08                                                                               >> $report
echo                                                                                   >> $report
cat $s09                                                                               >> $report
echo                                                                                   >> $report
cat $s10                                                                               >> $report
echo                                                                                   >> $report
cat $s11                                                                               >> $report
echo                                                                                   >> $report                                                                                   >> $report
cat $s12                                                                               >> $report
echo

echo                                                                                   >> $report
echo "########################## "                                                     >> $report
echo "#  PIPE                    "                                                     >> $report
echo "########################## "                                                     >> $report
echo                                                                                   >> $report
cat $pi01                                                                               >> $report
echo                                                                                   >> $report

echo                                                                                   >> $report
echo "########################## "                                                     >> $report
echo "#  LOG                     "                                                     >> $report
echo "########################## "                                                     >> $report
echo                                                                                   >> $report
cat $l01                                                                               >> $report
echo                                                                                   >> $report

echo                                                                                   >> $report
echo "----------------------------------------------------------------------"          >> $report
echo                                                                                   >> $report

}

tar_result() {

echo -e "\033[1;36m============================================"
echo -e "* FINISH - Result File Packing"
echo -e "============================================\033[0;0m"
echo "# tar -czf $com_syschk.tar.gz $com_syschk"
if [ `which tar | wc -l` -eq 1 ]
  then
    tar -czf $com_syschk.tar.gz $com_syschk
	echo "# rm -rf $com_syschk"
	rm -rf $com_syschk
  else
    echo "  => tar Command Not Found "
fi

echo
echo
}

#########################################
main(){
#########################################
sys_check
create_report					
tar_result
}
#########################################

main



